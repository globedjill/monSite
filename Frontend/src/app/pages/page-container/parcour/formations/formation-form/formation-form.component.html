<section class='formationForm' fxLayoutAlign='center center'>
    <form [formGroup]='formationForm'>
        <mat-card>
            <mat-card-header>
                <mat-card-title>Nouvelle Formation</mat-card-title>
            </mat-card-header>
            <!-- INTIUTLE -->
            <mat-card-content>
                <div fxLayout='column'>
                    <mat-form-field appearance='fill'>
                        <mat-label>Formation</mat-label>
                        <input matInput type="text" formControlName='nomFormation' placeholder="Nom de la formation">
                        <mat-error *ngIf=""></mat-error>
                    </mat-form-field>
                    <mat-form-field appearance='fill'>
                        <mat-label>Option de la Formation</mat-label>
                        <input matInput type="text" placeholder="option" formControlName='option'>
                        <mat-error *ngIf=""></mat-error>
                    </mat-form-field>
                </div>
                <!-- IMAGE -->
                <div fxLayout='column'>
                    <div class='container' fxLayout='row' fxLayoutAlign='center center'>
                        <!-- S'affiche si nouvelle experience -->
                        <div class='image' *ngIf='!this.id || this.imageInstanceAModifier === false'>
                            <div class='content' fxLayout='column' fxGap='15px'>
                                <div *ngIf="this.noFile === true" class='upload' fxLayout='row' fxLayoutAlign='center center' (click)="openFile()">
                                    <mat-label>Ajouter une image</mat-label>
                                    <input (change)='addFile($event)' type="file" fxHide='true' formControlName='image' #fileInput>
                                    <mat-icon><span class="material-icons-outlined">file_download</span></mat-icon>
                                </div>
                                <div *ngIf='this.noFile === false'>
                                    <div class='file' *ngFor='let fileHolder of (filesHolder$ | async ); let i = index' fxLayout='column' fxLayoutAlign='center center'>
                                        <div class='fileUpload' *ngIf='fileHolder.progress$ | async; let progress ' fxLayout='column'>
                                            <div class='fileUpload' fxLayout='row' fxLayoutAlign='space-between center'>
                                                <span>{{ fileHolder.file.name }}</span>
                                                <span>{{ progress }}%</span>
                                                <span *ngIf='progress === 100'> Fichier enregistré </span>
                                                <mat-icon><span class="material-icons" (click)='deleteFile(i)'>clear</span></mat-icon>
                                            </div>
                                            <mat-progress-bar style="min-width: 150px;" mode='determinate' [value]='progress'></mat-progress-bar>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <!-- S'affiche si id experience pour modification -->
                        <div class='content' *ngIf='this.id' fxLayout='column' fxGap='15px'>
                            <!-- S'affiche lors de la modification apres recuperation des données -->
                            <div *ngIf='this.imageInstanceAModifier === true' class='fileUpload' fxLayout='column'>
                                <div class='fileUpload' fxLayout='row' fxLayoutAlign='space-between center'>
                                    <span>{{this.imageVal.split('/')[3]}}</span>
                                    <mat-icon><span class="material-icons" (click)='supprImgLinkmodif(this.imageVal)'>clear</span></mat-icon>
                                </div>
                            </div>
                        </div>
                    </div>
                    <mat-form-field appearance='fill'>
                        <mat-label>Description Image</mat-label>
                        <input matInput type="text" formControlName='alt' placeholder='alt'>
                        <mat-error *ngIf=""></mat-error>
                    </mat-form-field>
                </div>

                <!-- LOCALISATION -->
                <div fxLayout='column'>
                    <mat-form-field appearance='fill'>
                        <mat-label>Lieu</mat-label>
                        <input type="text" matInput formControlName='lieu' placeholder="Departement">
                        <mat-error *ngIf=""></mat-error>
                    </mat-form-field>
                    <mat-form-field appearance='fill'>
                        <mat-label>Adresse</mat-label>
                        <input type="text" matInput formControlName='adresse' placeholder="lieu">
                        <mat-error *ngIf=""></mat-error>
                    </mat-form-field>
                </div>
                <!-- DATE -->
                <div fxLayout='column'>
                    <mat-form-field appearance='fill'>
                        <mat-label>Date d'entrée</mat-label>
                        <input matInput [matDatepicker]='picker' formControlName='dateEntree'>
                        <mat-datepicker-toggle matSuffix [for]='picker'></mat-datepicker-toggle>
                        <mat-datepicker #picker></mat-datepicker>
                    </mat-form-field>
                    <mat-form-field appearance='fill'>
                        <mat-label>Date de sortie</mat-label>
                        <input matInput [matDatepicker]='pickerSortie' formControlName='dateSortie'>
                        <mat-datepicker-toggle matSuffix [for]='pickerSortie'></mat-datepicker-toggle>
                        <mat-datepicker #pickerSortie></mat-datepicker>
                    </mat-form-field>
                </div>
                <!-- COMPLEMENT -->
                <div fxLayout='column'>
                    <mat-form-field appearance='fill'>
                        <mat-label>Contenu de la formation</mat-label>
                        <textarea matInput placeholder="De quoi est fait la formation" formControlName='contenu'></textarea>
                        <mat-error *ngIf=""></mat-error>
                    </mat-form-field>

                    <div formArrayName='liste' fxLayout='column'>
                        <button mat-raised-button (click)='addAxeListe()'>Ajouter un Objectif</button>
                        <div *ngFor='let axe of liste.controls; let i = index' fxLayout='row'>
                            <mat-form-field appearance='fill'>
                                <mat-label>Les points de formation </mat-label>
                                <input [formControlName]='i' type='text' matInput placeholder="Les différents axes" />
                                <mat-error *ngIf=""></mat-error>
                            </mat-form-field>
                            <button mat-raised-button (click)="deleteAxe(i)">-</button>
                        </div>
                    </div>
                    <mat-form-field appearance='fill' fxLAyoutAlign='start center'>
                        <mat-label>Lien vers le site </mat-label>
                        <input type='text' matInput placeholder="Liens" formControlName='lien' />
                        <mat-error *ngIf=""></mat-error>
                    </mat-form-field>
                </div>
            </mat-card-content>
            <mat-card-actions align="start">
                <button *ngIf='this.id' mat-raised-button (click)="onModify()">modifier
                </button>
                <button *ngIf='!this.id' mat-raised-button ngSubmit (click)="onSaveFormation()">Enregistrer</button>
                <button mat-raised-button (click)="retour()">Annuler</button>
            </mat-card-actions>

        </mat-card>
    </form>
</section>